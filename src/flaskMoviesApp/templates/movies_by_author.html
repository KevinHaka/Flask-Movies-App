{% extends "base.html" %}

{% block title %}
    Î¤Î±Î¹Î½Î¯ÎµÏ‚ Ï„Î¿Ï… {{ author.username }}
{% endblock title %}

{% block content %}

  <h2 class="aba_header">Î¤Î±Î¹Î½Î¯ÎµÏ‚ Î±Ï€Î¿ Ï„Î¿ Ï‡ÏÎ®ÏƒÏ„Î· {{ author.username }} 
  <img class="rounded-circle profile-image" alt="{{ author.username }}" src="{{ url_for('static', filename='images/profiles_images/'+author.profile_image) }}" data-holder-rendered="true" data-bs-toggle="tooltip" data-bs-placement="top" title="{{ author.username }}"></h2>

  <hr>
  <div class="align-buttons">
    {% for text,path in [('Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· Î²Î¬ÏƒÎµÎ¹ Î²Î±Î¸Î¼Î¿Î»Î¿Î³Î¯Î±Ï‚','rating'), ('Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· Î²Î¬ÏƒÎµÎ¹ Î­Ï„Î¿Ï…Ï‚ Ï€ÏÎ¿Î²Î¿Î»Î®Ï‚', 'release_year')] %}
      {% if path == ordering_by and sort in 'asc' %}
        <a class="{{ 'btn btn-primary btn-sm mt-1 mb-1' }}" href="{{ url_for('movies_by_author', author_id=author.id, sort='desc') }}">{{ text }}{{ ' ğŸ ‰' }}</a>

      {% elif path == ordering_by and sort == 'desc' %}
        <a class="{{ 'btn btn-primary btn-sm mt-1 mb-1' }}" href="{{ url_for('movies_by_author', author_id=author.id, ordering_by=path, sort='asc') }}">{{ text }}{{ ' ğŸ ‹' }}</a>

      {% else %}
        <a class="{{ 'btn btn-outline-primary btn-sm mt-1 mb-1' }}" href="{{ url_for('movies_by_author', author_id=author.id, ordering_by=path, sort='desc') }}">{{ text }}</a>

      {% endif %}
    {% endfor %}
  </div>
  <hr>

  {% if movies %}
    {% for movie in movies.items %}
      <div class="row my-3 p-3 bg-body rounded shadow-sm">
        <div class="col col-md-12">
          {% if movie.image != 'default_movie_image.png' %}
            <img src="{{ url_for('static', filename='images/movies_images/'+movie.image) }}" alt="" class="img-responsive a_image" height="360px">
          {% endif %}
        </div>

        <div class="col col-md-12">
          <div class="main-movie-title">
            <a class="movie_title" href="{{ url_for('movie', movie_id=movie.id) }}">{{ movie.title }} ({{ movie.release_year }}) [{{ movie.rating / 10 }}]</a>
          </div>

          <small class="movie_date">[{{ movie.date_created.strftime('%d-%m-%Y') }}]</small>

          <p class="main-movie-partial-text">
            {{ movie.plot | truncate(255) | safe }}
          </p>

          <p class="">Î‘Ï€ÏŒ 
            <span>
              <a class="author-name" href="{{ url_for('movies_by_author', author_id=movie.author.id) }}"> {{ movie.author.username }}
                <img class="rounded-circle profile-image" alt="{{ movie.author.username }}" src="{{ url_for('static', filename='images/profiles_images/'+movie.author.profile_image) }}" data-holder-rendered="true" data-bs-toggle="tooltip" data-bs-placement="top" title="{{ movie.author.username }}">
              </a>
            </span>
          </p>
        </div>
      </div>

      <hr>
    {% endfor %}

    <div>
      {% for page_number in movies.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_number %}
          {% if movies.page == page_number %}
            <a class="btn btn-primary" href="{{ url_for('movies_by_author', author_id=author.id, page=page_number, ordering_by=ordering_by, sort=sort) }}">{{ page_number }}</a>

          {% else %}
            <a class="btn btn-outline-primary" href="{{ url_for('movies_by_author', author_id=author.id, page=page_number, ordering_by=ordering_by, sort=sort) }}">{{ page_number }}</a>
          {% endif %}

        {% else %}
            <span>...</span>

        {% endif %}
      {% endfor %}
    </div>

  {% else %}
    <div class="alert alert-info alert-dismissible fade show" role="alert">Î”Îµ Î²ÏÎ­Î¸Î·ÎºÎµ ÎºÎ±Î¼Î¼Î¯Î± Ï„Î±Î¹Î½Î¯Î±</div>

  {% endif %}
{% endblock %}
